#!/usr/bin/env python

import os
import sys
import requests
import re
import webbrowser

VER = '2.0'
SEARCHSPLOIT_SCRIPT = '/usr/bin/searchsploit'
NMAP_SCRIPTS = '/usr/share/findsploit/nmap/nmap'
MSF_SEARCH_DIR = '/usr/share/findsploit/msf_search'
BROWSER_CMD = 'firefox'

REGEX = '^[0-9]+$'

def main():
    if len(sys.argv) == 1:
        print("Usage: ./exploitfinder.py ANY_EXPLOIT")
        sys.exit()
    else:
        search_term = ' '.join(sys.argv[1:])
        print(f"SEARCHING: {search_term}")
        print("NMAP SCRIPTS")
        os.system(f"egrep -i {search_term} {NMAP_SCRIPTS} | egrep -i {search_term} --color=auto")
        print("METASPLOIT EXPLOIT SEARCH")
        os.system(f"egrep -i {search_term} {MSF_SEARCH_DIR}/* | egrep -i {search_term} --color=auto")
        print("EXPLOITDB EXPLOITS")
        os.system(f"{SEARCHSPLOIT_SCRIPT} {search_term}")
        print(f"https://www.exploit-db.com/search?q={'+'.join(search_term.split())}")
        print(f"https://www.google.ca/search?q={'%20'.join(search_term.split())}%20exploit")
        print(f"https://www.google.ca/search?q={'%20'.join(search_term.split())}%20exploit%20site:www.securityfocus.com")
        print(f"https://www.google.ca/search?q={'%20'.join(search_term.split())}%20site:0day.today")
        print(f"https://www.google.ca/search?q={'%20'.join(search_term.split())}%20site:www.security-database.com")
        print(f"https://www.google.ca/search?q={'%20'.join(search_term.split())}%20site:packetstormsecurity.com")
        print(f"https://exploits.shodan.io/?q={'+'.join(search_term.split())}")
        print(f"https://vulners.com/search?query={'+'.join(search_term.split())}")
        print("Press any key to search online or Ctrl+C to exit...")
        input()
        for url in [
            'https://sn1persecurity.com',
            f'https://www.exploit-db.com/search?q={"+".join(search_term.split())}',
            f'https://www.google.ca/search?q={"%20".join(search_term.split())}%20exploit',
            f'https://www.google.ca/search?q={"%20".join(search_term.split())}%20exploit%20site:www.securityfocus.com',
            f'https://www.google.ca/search?q={"%20".join(search_term.split())}%20site:0day.today',
            f'https://www.google.ca/search?q={"%20".join(search_term.split())}%20site:www.security-database.com',
            f'https://www.google.ca/search?q={"%20".join(search_term.split())}%20site:packetstormsecurity.com',
            f'https://exploits.shodan.io/?q={"+".join(search_term.split())}',
            f'https://vulners.com/search?query={"+".join(search_term.split())}'
        ]:
            webbrowser.open(url, new=2)

if __name__ == "__main__":
    main()
